# ==================== 监控配置 ====================
monitoring:
  check_interval_seconds: 60
  data_buffer_size: 100
  max_consecutive_failures: 5
  component_name: "towing_winch"

  # 故障阈值
  fault_threshold:
    mechanical_system: 70
    overall_health: 60

  # 子系统权重（用于计算整体健康度）
  # mechanical: 机械系统，使用振动数据
  health_score_weights:
    mechanical_system: 1.0  # 机械系统占100%

  # 各子系统的组件及其权重
  system_components:
    mechanical_system:
      gearbox: 0.5    # 齿轮箱占50%（主要使用ch3-ch5数据）
      motor: 0.5      # 电机占50%（主要使用ch1-ch2数据）

# ==================== 健康指标计算配置 ====================
health_indicators:
  # 启用的健康指标类型（用于振动数据分析）
  enabled_indicators:
    - "kurtosis"         # 峭度 - 反映信号的尖峰程度
    - "crest_factor"     # 峰值因子 - 峰值与RMS的比值
    - "shape_factor"     # 形状因子 - RMS与平均值的比值
    - "impulse_factor"   # 冲击因子 - 峰值与平均值的比值
    - "margin_factor"    # 裕度因子 - 峰值与方根幅值的比值
    - "clearance_factor" # 间隙因子 - 峰值与方根幅值平方的比值

  # 指标权重配置（总和应为1.0）
  indicator_weights:
    kurtosis: 0.25
    crest_factor: 0.20
    shape_factor: 0.15
    impulse_factor: 0.15
    margin_factor: 0.15
    clearance_factor: 0.10

  # 健康指标映射配置（从指标值到健康分数的映射）
  health_mapping:
    # 健康基准值（100分对应的指标值）
    healthy_baseline:
      kurtosis: 3.0
      crest_factor: 3.0
      shape_factor: 1.5
      impulse_factor: 4.5
      margin_factor: 6.0
      clearance_factor: 8.0

    # 故障阈值（0分对应的指标值）
    fault_threshold:
      kurtosis: 15.0
      crest_factor: 12.0
      shape_factor: 6.0
      impulse_factor: 20.0
      margin_factor: 25.0
      clearance_factor: 35.0

    # 映射函数类型：linear（线性）/ exponential（指数）/ logarithmic（对数）
    mapping_function: "exponential"
    # 指数函数参数（当mapping_function为exponential时使用）
    exponential_factor: 2.0


# ==================== 特征收集与模型训练配置 ====================
feature_collection:
  # 数据收集时长配置
  collection_duration_months: 3  # 收集前N个月的数据

  # 特征收集总开关
  enable_feature_extraction: false  # 是否启用特征提取和模型训练

  # 特征存储配置
  feature_storage:
    base_path: "./features_by_rpm"  # 特征存储基础路径
    enable_channel_separation: true  # 是否按通道分别存储
    channel_subdirs: ["ch1", "ch2", "ch3", "ch4", "ch5"]  # 通道子目录

  # 特征提取参数
  feature_extraction:
    segment_length: 2048  # 分段长度（采样点数）
    overlap_ratio: 0.5    # 重叠率
    n_mfcc: 13           # MFCC特征数量
    n_gtcc: 13           # GTCC特征数量
    n_fft: 2048          # FFT点数
    hop_length: 512      # 跳跃长度
    n_gammatone_bands: 40 # Gammatone滤波器组数量

  # 自动触发模型训练配置
  auto_training:
    enable: true
    check_interval_hours: 6  # 检查间隔（小时）
    speed_range_config_file: "config/speed_ranges.csv"  # 转速区间配置文件

# ==================== SVDD模型配置 ====================
svdd_model:
  # 模型存储配置
  model_storage:
    base_path: "./models"  # 模型存储基础路径
    model_name_pattern: "svdd_model_{channel}_{speed_range}.pkl"  # 模型文件命名模式

  # SVDD训练参数（当有外部SVDD实现时的预留配置）
  training_params:
    kernel: "rbf"      # 核函数类型
    gamma: "scale"     # RBF核参数
    nu: 0.05          # 异常值比例
    max_iter: 1000    # 最大迭代次数

  # 模型输出处理
  output_processing:
    # 输出值到健康分数的映射
    healthy_threshold: -0.1    # 正常样本的决策边界
    fault_threshold: 0.5       # 故障样本的决策边界
    score_weight: 0.3          # SVDD分数在最终健康指标中的权重

# ==================== 转速区间配置 ====================
speed_ranges:
  # 默认转速区间配置（当CSV文件不存在时使用）
  default_ranges:
    - start_rpm: 0
      end_rpm: 500
      min_samples: 100
    - start_rpm: 500
      end_rpm: 1000
      min_samples: 150
    - start_rpm: 1000
      end_rpm: 1500
      min_samples: 200
    - start_rpm: 1500
      end_rpm: 2000
      min_samples: 150
    - start_rpm: 2000
      end_rpm: 3000
      min_samples: 100

# ==================== 集成模式配置 ====================
integration:
  # 健康指标权重（用于集成多种诊断方法）
  health_indicator_weight: 0.6  # 健康指标的权重
  svdd_weight: 0.4              # SVDD模型的权重